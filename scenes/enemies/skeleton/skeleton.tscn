[gd_scene format=3 uid="uid://xoaana6wd66l"]

[ext_resource type="Script" uid="uid://d16ieatpa6gb8" path="res://scripts/test_enemy.gd" id="1_fpxyv"]
[ext_resource type="Shader" uid="uid://dvhvceqt0c3ol" path="res://shaders/hit_flash.gdshader" id="2_b36fj"]
[ext_resource type="Texture2D" uid="uid://b77qmvhfn17cn" path="res://assets/Skeleton_White/Skeleton_With_VFX/Skeleton_01_White_Walk.png" id="2_m1dgl"]
[ext_resource type="Script" uid="uid://bo0ibaxyi3y8j" path="res://scripts/hurtbox.gd" id="2_mkyue"]
[ext_resource type="PackedScene" uid="uid://70283chaxaxy" path="res://scenes/enemies/skeleton/skeleton_weapon.tscn" id="3_t46gg"]
[ext_resource type="Script" uid="uid://br8s2pfencfh7" path="res://scripts/state_machine.gd" id="4_lkcdx"]
[ext_resource type="Script" uid="uid://b8u813j30u3cx" path="res://scripts/enemy_state_machine/enemy_idle.gd" id="5_8c00y"]
[ext_resource type="Script" uid="uid://dinglix0mke55" path="res://scripts/enemy_state_machine/enemy_chasing.gd" id="6_jqw88"]
[ext_resource type="Script" uid="uid://bi7nueyq3bnkh" path="res://scripts/enemy_state_machine/enemy_attacking.gd" id="7_1y3pe"]
[ext_resource type="Script" uid="uid://bauv1ijhod0mc" path="res://scripts/enemy_animation.gd" id="9_dddk1"]
[ext_resource type="Script" uid="uid://st6nl2uuyv25" path="res://scripts/enemy_state_machine/enemy_wait.gd" id="9_hsgsh"]
[ext_resource type="Script" uid="uid://bngnoi6xqp0hr" path="res://scripts/parried.gd" id="10_ccqoy"]
[ext_resource type="Texture2D" uid="uid://du4124uw7xq3t" path="res://assets/Skeleton_White/Skeleton_With_VFX/Skeleton_01_White_Attack1.png" id="13_ausen"]
[ext_resource type="AnimationNodeStateMachine" uid="uid://sccv00c6phxu" path="res://scenes/enemies/skeleton/skeleton_anim_state_machine.tres" id="13_m1dgl"]
[ext_resource type="Texture2D" uid="uid://dlyonxryqfvwm" path="res://assets/Skeleton_White/Skeleton_With_VFX/Skeleton_01_White_Idle.png" id="13_q4b65"]
[ext_resource type="PackedScene" uid="uid://o1grnxkiwyi" path="res://scenes/stats_handler.tscn" id="16_v6rpr"]
[ext_resource type="PackedScene" uid="uid://c8qmt5mslgb05" path="res://scenes/stagger_bar.tscn" id="18_b36fj"]
[ext_resource type="Script" uid="uid://bnvuyxwj3e7h8" path="res://scripts/stats.gd" id="18_yjy0a"]

[sub_resource type="Resource" id="Resource_b36fj"]
resource_local_to_scene = true
script = ExtResource("18_yjy0a")
base_max_health = 50
base_attack = 5
faction = 1
metadata/_custom_type_script = "uid://bnvuyxwj3e7h8"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_adimu"]
resource_local_to_scene = true
shader = ExtResource("2_b36fj")
shader_parameter/hit_flash_color = Color(1, 1, 1, 1)
shader_parameter/hit_flash_on = false

[sub_resource type="RectangleShape2D" id="RectangleShape2D_mkyue"]
size = Vector2(25, 46)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_h17bh"]
size = Vector2(27, 46)

[sub_resource type="Animation" id="Animation_dddk1"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [Vector2i(0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:texture")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("2_m1dgl")]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite2D:hframes")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [10]
}

[sub_resource type="Animation" id="Animation_t46gg"]
resource_name = "attack"
length = 0.6
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.06666667, 0.13333334, 0.2, 0.26666668, 0.35, 0.4, 0.46666667, 0.53333336, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0), Vector2i(7, 0), Vector2i(8, 0), Vector2i(9, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:texture")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("13_ausen")]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite2D:hframes")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [10]
}

[sub_resource type="Animation" id="Animation_vp4s7"]
resource_name = "idle"
length = 0.75
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6018633, 0.7015696),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0), Vector2i(7, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:texture")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("13_q4b65")]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite2D:hframes")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [8]
}

[sub_resource type="Animation" id="Animation_hsgsh"]
resource_name = "run"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.10000001, 0.20000002, 0.3, 0.40000004, 0.5, 0.6, 0.70000005, 0.8000001, 0.90000004),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0), Vector2i(7, 0), Vector2i(8, 0), Vector2i(9, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:texture")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("2_m1dgl")]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite2D:hframes")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [10]
}

[sub_resource type="Animation" id="Animation_m1dgl"]
resource_name = "stunned"

[sub_resource type="AnimationLibrary" id="AnimationLibrary_vp4s7"]
_data = {
&"RESET": SubResource("Animation_dddk1"),
&"attack": SubResource("Animation_t46gg"),
&"idle": SubResource("Animation_vp4s7"),
&"run": SubResource("Animation_hsgsh"),
&"stunned": SubResource("Animation_m1dgl")
}

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_q4b65"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_ausen"]
graph_offset = Vector2(67.5, 5.200001)
nodes/output/position = Vector2(580, 140)
nodes/EnemyState/node = ExtResource("13_m1dgl")
nodes/EnemyState/position = Vector2(80, 120)
nodes/TimeScale/node = SubResource("AnimationNodeTimeScale_q4b65")
nodes/TimeScale/position = Vector2(400, 120)
node_connections = [&"output", 0, &"TimeScale", &"TimeScale", 0, &"EnemyState"]

[node name="Skeleton" type="CharacterBody2D" unique_id=642849839 groups=["Enemy"]]
script = ExtResource("1_fpxyv")

[node name="StateMachine" type="Node" parent="." unique_id=1109154398 node_paths=PackedStringArray("initial_state")]
unique_name_in_owner = true
script = ExtResource("4_lkcdx")
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="StateMachine" unique_id=609235104 node_paths=PackedStringArray("enemy")]
script = ExtResource("5_8c00y")
enemy = NodePath("../..")

[node name="Chasing" type="Node" parent="StateMachine" unique_id=1884508695 node_paths=PackedStringArray("enemy")]
script = ExtResource("6_jqw88")
enemy = NodePath("../..")

[node name="Attacking" type="Node" parent="StateMachine" unique_id=1302839748 node_paths=PackedStringArray("enemy")]
script = ExtResource("7_1y3pe")
enemy = NodePath("../..")

[node name="Wait" type="Node" parent="StateMachine" unique_id=2143819824]
script = ExtResource("9_hsgsh")

[node name="Parried" type="Node" parent="StateMachine" unique_id=501702812]
script = ExtResource("10_ccqoy")

[node name="EnemyAnimation" type="Node" parent="." unique_id=901943169 node_paths=PackedStringArray("enemy", "animation_tree")]
script = ExtResource("9_dddk1")
enemy = NodePath("..")
animation_tree = NodePath("../AnimationTree")

[node name="StatsHandler" parent="." unique_id=879032711 node_paths=PackedStringArray("target") instance=ExtResource("16_v6rpr")]
unique_name_in_owner = true
stats = SubResource("Resource_b36fj")
target = NodePath("..")

[node name="Sprite2D" type="Sprite2D" parent="." unique_id=319657665]
texture_filter = 1
material = SubResource("ShaderMaterial_adimu")
texture = ExtResource("2_m1dgl")
hframes = 10

[node name="CollisionShape2D" type="CollisionShape2D" parent="." unique_id=1504981636]
position = Vector2(-1.5, 9)
shape = SubResource("RectangleShape2D_mkyue")

[node name="EnemyWeapon" parent="." unique_id=1705720724 instance=ExtResource("3_t46gg")]
visible = false
position = Vector2(12, 0)

[node name="Hurtbox" type="Area2D" parent="." unique_id=104782618]
script = ExtResource("2_mkyue")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hurtbox" unique_id=1424993761]
position = Vector2(-1.5, 9)
shape = SubResource("RectangleShape2D_h17bh")
debug_color = Color(0.98338693, 0, 0.35783058, 0.41960785)

[node name="AnimationPlayer" type="AnimationPlayer" parent="." unique_id=1284578189]
libraries/ = SubResource("AnimationLibrary_vp4s7")

[node name="AnimationTree" type="AnimationTree" parent="." unique_id=984783966]
tree_root = SubResource("AnimationNodeBlendTree_ausen")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../AnimationPlayer")
parameters/EnemyState/conditions/attacking = false
parameters/EnemyState/conditions/parried = false
parameters/TimeScale/scale = 1.0

[node name="AudioManager" type="Node2D" parent="." unique_id=1997844058]
unique_name_in_owner = true

[node name="UI" type="Control" parent="." unique_id=923925975]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="StaggerBar" parent="UI" unique_id=1497311889 node_paths=PackedStringArray("target") instance=ExtResource("18_b36fj")]
layout_mode = 0
offset_top = -21.0
offset_bottom = -17.0
target = NodePath("../../StatsHandler")
